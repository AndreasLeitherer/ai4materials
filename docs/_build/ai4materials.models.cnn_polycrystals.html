

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ai4materials.models.cnn_polycrystals module &mdash; ai4materials v0.1.0</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ai4materials.models.embedding module" href="ai4materials.models.embedding.html" />
    <link rel="prev" title="ai4materials.models.cnn_nature_comm_ziletti2018 module" href="ai4materials.models.cnn_nature_comm_ziletti2018.html" />
    <link href="_static/nomad-analytics.css" rel="stylesheet" type="text/css">


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ai4materials
          

          
            
            <img src="_static/ai_for_materials_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.dataprocessing.html">Data preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.descriptors.html">Representing crystal structures: descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.wrappers.html">Creating and loading materials science datasets</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ai4materials.models.html">Regression and classification models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ai4materials.models.html#module-ai4materials.models.l1_l0-example">Example regression: LASSO+l0 method</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ai4materials.models.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.clustering.html">ai4materials.models.clustering module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.cnn_architectures.html">ai4materials.models.cnn_architectures module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.cnn_nature_comm_ziletti2018.html">ai4materials.models.cnn_nature_comm_ziletti2018 module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ai4materials.models.cnn_polycrystals module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.embedding.html">ai4materials.models.embedding module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.l1_l0.html">ai4materials.models.l1_l0 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.sis.html">ai4materials.models.sis module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.strided_pattern_matching.html">ai4materials.models.strided_pattern_matching module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ai4materials.models.html#module-ai4materials.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.interpretation.html">Neural network interpretation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ai4materials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="ai4materials.models.html">Regression and classification models</a> &raquo;</li>
        
      <li>ai4materials.models.cnn_polycrystals module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ai4materials.models.cnn_polycrystals.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-ai4materials.models.cnn_polycrystals">
<span id="ai4materials-models-cnn-polycrystals-module"></span><h1>ai4materials.models.cnn_polycrystals module<a class="headerlink" href="#module-ai4materials.models.cnn_polycrystals" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="ai4materials.models.cnn_polycrystals.normalize_images">
<code class="descclassname">ai4materials.models.cnn_polycrystals.</code><code class="descname">normalize_images</code><span class="sig-paren">(</span><em>images</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/cnn_polycrystals.html#normalize_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.cnn_polycrystals.normalize_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ai4materials.models.cnn_polycrystals.predict">
<code class="descclassname">ai4materials.models.cnn_polycrystals.</code><code class="descname">predict</code><span class="sig-paren">(</span><em>data_set</em>, <em>nb_classes</em>, <em>configs</em>, <em>results_file</em>, <em>numerical_labels</em>, <em>text_labels</em>, <em>checkpoint_dir=None</em>, <em>checkpoint_filename=None</em>, <em>batch_size=1</em>, <em>show_model_acc=True</em>, <em>mc_samples=1</em>, <em>predict_probabilities=True</em>, <em>plot_conf_matrix=True</em>, <em>conf_matrix_file=None</em>, <em>normalize=False</em>, <em>verbose=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/cnn_polycrystals.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.cnn_polycrystals.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ai4materials.models.cnn_polycrystals.predict_with_uncertainty">
<code class="descclassname">ai4materials.models.cnn_polycrystals.</code><code class="descname">predict_with_uncertainty</code><span class="sig-paren">(</span><em>data</em>, <em>model</em>, <em>model_type='classification'</em>, <em>n_iter=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/cnn_polycrystals.html#predict_with_uncertainty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.cnn_polycrystals.predict_with_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>This function allows to calculate the uncertainty of a neural network model using dropout.</p>
<p>This follows Chap. 3 in Yarin Gal’s PhD thesis:
<a class="reference external" href="http://mlg.eng.cam.ac.uk/yarin/thesis/thesis.pdf">http://mlg.eng.cam.ac.uk/yarin/thesis/thesis.pdf</a></p>
<dl class="docutils">
<dt>We calculate the uncertainty of the neural network predictions in the three ways proposed in Gal’s PhD thesis,</dt>
<dd>as presented at pag. 51-54:</dd>
</dl>
<ul class="simple">
<li>variation_ratio: defined in Eq. 3.19</li>
<li>predictive_entropy: defined in Eq. 3.20</li>
<li>mutual_information: defined at pag. 53 (no Eq. number)</li>
</ul>
<p>Note: the current implementation works only for neural networks with layers that have the same behaviour
at training and test time. For example, fully connected layers and convolution layers are allowed,
while batch normalization layers are not.</p>
<p>This is because the whole behaviour of the network is changed to the training learning phase, so that
the dropout is used by Keras.</p>
<p>Keras will soon implement a Dropout which can be kept also at test time; when this will be release, the function
<code class="docutils literal notranslate"><span class="pre">f</span></code> below will no longer be necessary.</p>
<p><em>Code author: Angelo Ziletti &lt;<a class="reference external" href="mailto:angelo&#46;ziletti&#37;&#52;&#48;gmail&#46;com">angelo<span>&#46;</span>ziletti<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</em></p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.cnn_polycrystals.reshape_images">
<code class="descclassname">ai4materials.models.cnn_polycrystals.</code><code class="descname">reshape_images</code><span class="sig-paren">(</span><em>images</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/cnn_polycrystals.html#reshape_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.cnn_polycrystals.reshape_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ai4materials.models.cnn_polycrystals.train_neural_network">
<code class="descclassname">ai4materials.models.cnn_polycrystals.</code><code class="descname">train_neural_network</code><span class="sig-paren">(</span><em>data_set</em>, <em>configs</em>, <em>batch_size</em>, <em>nb_classes</em>, <em>nb_epoch</em>, <em>img_channels</em>, <em>partial_model_architecture</em>, <em>normalize=False</em>, <em>checkpoint_dir=None</em>, <em>checkpoint_filename=None</em>, <em>training_log_file='training.log'</em>, <em>early_stopping=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/cnn_polycrystals.html#train_neural_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.cnn_polycrystals.train_neural_network" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ai4materials.models.embedding.html" class="btn btn-neutral float-right" title="ai4materials.models.embedding module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ai4materials.models.cnn_nature_comm_ziletti2018.html" class="btn btn-neutral" title="ai4materials.models.cnn_nature_comm_ziletti2018 module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Angelo Ziletti.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>