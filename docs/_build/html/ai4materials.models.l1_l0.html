

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ai4materials.models.l1_l0 module &mdash; ai4materials v0.1.0</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="ai4materials v0.1.0" href="index.html"/>
        <link rel="up" title="Regression and classification models" href="ai4materials.models.html"/>
        <link rel="next" title="ai4materials.models.sis module" href="ai4materials.models.sis.html"/>
        <link rel="prev" title="ai4materials.models.embedding module" href="ai4materials.models.embedding.html"/>
    <link href="_static/nomad-analytics.css" rel="stylesheet" type="text/css">


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ai4materials
          

          
            
            <img src="_static/ai_for_materials_logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.dataprocessing.html">Data preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.descriptors.html">Representing crystal structures: descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.wrappers.html">Creating and loading materials science datasets</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ai4materials.models.html">Regression and classification models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ai4materials.models.html#module-ai4materials.models.l1_l0-example">Example regression: LASSO+l0 method</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ai4materials.models.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.clustering.html">ai4materials.models.clustering module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.cnn_architectures.html">ai4materials.models.cnn_architectures module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.cnn_nature_comm_ziletti2018.html">ai4materials.models.cnn_nature_comm_ziletti2018 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.cnn_polycrystals.html">ai4materials.models.cnn_polycrystals module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.embedding.html">ai4materials.models.embedding module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ai4materials.models.l1_l0 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.sis.html">ai4materials.models.sis module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ai4materials.models.strided_pattern_matching.html">ai4materials.models.strided_pattern_matching module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ai4materials.models.html#module-ai4materials.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.interpretation.html">Neural network interpretation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ai4materials.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ai4materials</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="ai4materials.models.html">Regression and classification models</a> &raquo;</li>
        
      <li>ai4materials.models.l1_l0 module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ai4materials.models.l1_l0.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-ai4materials.models.l1_l0">
<span id="ai4materials-models-l1-l0-module"></span><h1>ai4materials.models.l1_l0 module<a class="headerlink" href="#module-ai4materials.models.l1_l0" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="ai4materials.models.l1_l0.choose_atomic_features">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">choose_atomic_features</code><span class="sig-paren">(</span><em>selected_feature_list=None</em>, <em>atomic_data_file=None</em>, <em>binary_data_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#choose_atomic_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.choose_atomic_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose primary features for the extended lasso procedure.</p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.classify_rs_zb">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">classify_rs_zb</code><span class="sig-paren">(</span><em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#classify_rs_zb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.classify_rs_zb" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify if a structure is rocksalt of zincblend from a list of NoMaD structure.
(one json file). Supports multiple frames (TO DO: check that). Hard-coded.</p>
<p>rocksalt:
atom_frac1 0.0 0.0 0.0
atom_frac2 0.5 0.5 0.5</p>
<p>zincblende:
atom_frac1 0.0  0.0  0.0
atom_frac2 0.25 0.25 0.25</p>
<p>zincblende –&gt; label=0
rocksalt  –&gt; label=1</p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.combine_features">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">combine_features</code><span class="sig-paren">(</span><em>df=None</em>, <em>energy_unit=None</em>, <em>length_unit=None</em>, <em>metadata_info=None</em>, <em>allowed_operations=None</em>, <em>derived_features=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#combine_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.combine_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate combination of features given a dataframe and a list of allowed operations.</p>
<p>For the exponentials, we introduce a characteristic energy/length
converting the
..todo:: Fix under/overflow errors, and introduce handling of exceptions.</p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.e_sqrt_z">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">e_sqrt_z</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#e_sqrt_z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.e_sqrt_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates e/sqrt(val_Z).</p>
<p>Es/sqrt(Zval) and Ep/sqrt(Zval) from Phys. Rev. B 85, 104104 (2012).
Input Es(A) or Ep(A), val(A)  (A–&gt;B)
They need to be given in this order.</p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.get_energy_diff">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">get_energy_diff</code><span class="sig-paren">(</span><em>chemical_formula_list</em>, <em>energy_list</em>, <em>label_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#get_energy_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.get_energy_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain difference in energy (eV) between rocksalt and zincblend structures of a given binary.</p>
<p>From a list of chemical formulas, energies and labels returns a dictionary
with {<cite>material</cite>: <cite>delta_e</cite>} where <cite>delta_e</cite> is the difference between the energy
with label 1 and energy with label 0, grouped by material.
Each element of such list corresponds to a json file.
The <cite>delta_e</cite> is exactly what reported in the PRL 114, 105503(2015).</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Check if it works for multiple frames.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.get_lowest_energy_structures">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">get_lowest_energy_structures</code><span class="sig-paren">(</span><em>structure</em>, <em>dict_delta_e</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#get_lowest_energy_structures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.get_lowest_energy_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lowest energy structure for each material and label type.</p>
<p>Works only with two possible labels for a given material.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Check if it works for multiple frames.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.l1_l0_minimization">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">l1_l0_minimization</code><span class="sig-paren">(</span><em>y_true</em>, <em>D</em>, <em>features</em>, <em>energy_unit=None</em>, <em>print_lasso=False</em>, <em>lambda_grid=None</em>, <em>lassonumber=25</em>, <em>max_dim=3</em>, <em>lambda_grid_points=100</em>, <em>lambda_max_factor=1.0</em>, <em>lambda_min_factor=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#l1_l0_minimization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.l1_l0_minimization" title="Permalink to this definition">¶</a></dt>
<dd><p>Select an optimal descriptor using a combined l1-l0 procedure.</p>
<ol class="arabic simple">
<li>step (l 1): Solve the LASSO minimization problem</li>
</ol>
<div class="math notranslate nohighlight">
\[argmin_c {||P-Dc||^2 + \lambda |c|_1}\]</div>
<p>for different lambdas, starting from a ‘high’ lambda.
Collect all indices(Features) i appearing with nonzero coefficients c_i,
while decreasing lambda, until size of collection equals <cite>lassonumber</cite>.</p>
<ol class="arabic simple" start="2">
<li><dl class="first docutils">
<dt>step (l 0): Check the least-squares errors for all single features/pairs/triples/… of</dt>
<dd>collection from 1. step. Choose the single/pair/triple/… with the lowest
mean squared error (MSE) to be the best 1D/2D/3D-descriptor.</dd>
</dl>
</li>
</ol>
<p>Parameters:</p>
<dl class="docutils">
<dt>y_true <span class="classifier-delimiter">:</span> <span class="classifier">array, [n_samples]</span></dt>
<dd>Array with the target property (ground truth)</dd>
<dt>D <span class="classifier-delimiter">:</span> <span class="classifier">array, [n_samples, n_features]</span></dt>
<dd>Matrix with the data.</dd>
<dt>features <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd>List of feature names. Needs to be in the same order as the feature vectors in D</dd>
<dt>dimrange <span class="classifier-delimiter">:</span> <span class="classifier">list of int</span></dt>
<dd>Specify for which dimensions the optimal descriptor is calculated.
It is the number of feature vectors used in the linear combination</dd>
<dt>lassonumber <span class="classifier-delimiter">:</span> <span class="classifier">int, default 25</span></dt>
<dd>The number of features, which will be collected in ther l1-step</dd>
<dt>lamdba_grid_points <span class="classifier-delimiter">:</span> <span class="classifier">int, default 100</span></dt>
<dd>Number of lamdbas between lamdba_max and lambdba_min for which the l1-problem shall be solved.
Sometimes a denser grid could be needed, if the lamda-steps are too high.
This can be checked with ‘print_lasso’. <cite>lamdba_max</cite> and <cite>lamdba_min</cite> are chosen as in
Tibshirani’s paper “Regularization Paths for Generalized Linear Models via Coordinate Descent”.
The values in between are generated on the log scale.</dd>
<dt>lambda_min_factor <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.001</span></dt>
<dd>Sets <cite>lam_min</cite> = <cite>lambda_min_factor</cite> * <cite>lam_max</cite>.</dd>
<dt>lambda_max_factor <span class="classifier-delimiter">:</span> <span class="classifier">float, default 1.0</span></dt>
<dd>Sets calculated <cite>lam_max</cite> = <cite>lam_max</cite> * <cite>lambda_max_factor</cite>.</dd>
<dt>print_lasso: bool, default <cite>True</cite></dt>
<dd>Prints the indices of coulumns of <cite>D</cite> with nonzero coefficients for each lambda.</dd>
<dt>lambda_grid: array</dt>
<dd>The list/array of lambda values for the l1-problem can be chosen by the user.
The list/array should start from the highest number and lambda_i &gt; lamda_i+1 should hold.
(?) <cite>lambda_grid_point</cite> is then ignored. (?)</dd>
</dl>
<p>Returns:</p>
<p>list of panda dataframes
(D’, c’, selected_features) :</p>
<blockquote>
<div>A list of tuples (D’,c’,selected_features) for each dimension.
<cite>selected_features</cite> is a list of strings. D’<a href="#id1"><span class="problematic" id="id2">*</span></a>c’ is the selected linear model/fit where the last column
of <cite>D</cite> is a vector with ones.</div></blockquote>
<p>References:</p>
<table class="docutils citation" frame="void" id="r6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R6]</td><td>Luca M. Ghiringhelli, Jan Vybiral, Sergey V. Levchenko, Claudia Draxl, and Matthias Scheffler,
“Big Data of Materials Science: Critical Role of the Descriptor”
Phys. Rev. Lett. 114, 105503 (2015)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.r_pi">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">r_pi</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#r_pi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.r_pi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates r_pi.</p>
<p>John-Bloch’s indicator2: <a href="#id3"><span class="problematic" id="id4">|rp(A) - rs(A)|</span></a> +| rp(B) -rs(B)| from Phys. Rev. Lett. 33, 1095 (1974).
Input rp(A), rs(A), rp(B), rs(B)
They need to be given in this order.
combine_features</p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.r_sigma">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">r_sigma</code><span class="sig-paren">(</span><em>row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#r_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.r_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates r_sigma.</p>
<p>John-Bloch’s indicator1: <a href="#id5"><span class="problematic" id="id6">|rp(A) + rs(A) - rp(B) -rs(B)|</span></a> from Phys. Rev. Lett. 33, 1095 (1974).</p>
<p>Input rp(A), rs(A), rp(B), rs(B)
They need to be given in this order.</p>
</dd></dl>

<dl class="function">
<dt id="ai4materials.models.l1_l0.write_atomic_features">
<code class="descclassname">ai4materials.models.l1_l0.</code><code class="descname">write_atomic_features</code><span class="sig-paren">(</span><em>structure</em>, <em>selected_feature_list</em>, <em>df</em>, <em>dict_delta_e=None</em>, <em>path=None</em>, <em>filename_suffix='.json'</em>, <em>json_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ai4materials/models/l1_l0.html#write_atomic_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ai4materials.models.l1_l0.write_atomic_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the chemical composition, build the descriptor made of atomic features only.</p>
<p>Includes all the frames in the same json file.</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">Check if it works for multiple frames.</p>
</div>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ai4materials.models.sis.html" class="btn btn-neutral float-right" title="ai4materials.models.sis module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ai4materials.models.embedding.html" class="btn btn-neutral" title="ai4materials.models.embedding module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Angelo Ziletti.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>