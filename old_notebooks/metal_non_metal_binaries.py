#!/usr/bin/python
# coding=utf-8
# Copyright 2016-2018 Angelo Ziletti
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
from __future__ import absolute_import

__author__ = "Angelo Ziletti"
__copyright__ = "Copyright 2016-2018, The NOMAD Project"
__maintainer__ = "Angelo Ziletti"
__email__ = "ziletti@fhi-berlin.mpg.de"
__date__ = "20/04/18"

if __name__ == "__main__":
    import sys
    import os.path

    atomic_data_dir = os.path.normpath('/home/ziletti/nomad/nomad-lab-base/analysis-tools/atomic-data')
    sys.path.insert(0, atomic_data_dir)

    from pint import UnitRegistry
    from ase.spacegroup import get_spacegroup
    from future.utils import viewitems
    from ai4materials.utils.utils_config import read_configs
    from ai4materials.utils.utils_config import setup_logger
    from ai4materials.utils.utils_crystals import create_supercell, substitute_atoms
    from ai4materials.utils.utils_data_retrieval import read_ase_db
    from ai4materials.utils.utils_crystals import convert_energy_substance
    from ai4materials.visualization.viewer import Viewer
    from ai4materials.utils.utils_data_retrieval import write_ase_db
    from ai4materials.utils.utils_crystals import get_spacegroup_old
    from ai4materials.utils.utils_parsing import nmd_uri_to_ase_atoms_tmp
    from ai4materials.utils.utils_binaries import get_energy_diff_by_spacegroup
    from ai4materials.wrappers import calc_descriptor
    from ai4materials.wrappers import load_descriptor
    import seaborn as sns
    from ai4materials.wrappers import calc_model, calc_embedding, plot
    from ai4materials.descriptors.atomic_features import AtomicFeatures
    from ai4materials.descriptors.atomic_features import get_table_atomic_features
    from ai4materials.descriptors.diffraction2d import Diffraction2D
    from nomadcore.local_meta_info import loadJsonFile, InfoKindEl
    from ai4materials.wrappers import get_json_list
    from ai4materials.utils.utils_parsing import read_data
    import random
    import json
    from ai4materials.visualization.viewer import read_control_file
    import hashlib
    import datetime
    import numpy as np
    import pandas as pd

    # read config file
    config_file = '/home/ziletti/Documents/nomadml_docs/config_default.yml'
    configs = read_configs(config_file)
    logger = setup_logger(configs, level='DEBUG', display_configs=False)
    ureg = UnitRegistry(os.path.normpath(configs["others"]["ureg_file"]))

    # setup folder and files
    main_folder = '/home/ziletti/Documents/nomadml_docs/'
    tmp_folder = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'tmp')))
    desc_folder = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'desc_folder')))
    results_folder = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'results')))
    desc_info_file = os.path.abspath(os.path.normpath(os.path.join(desc_folder, 'desc_info.json.info')))
    table_file = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'atomic_features_table.csv')))
    figure_file = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'atomic_features_plot.png')))
    control_file = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'control.json')))
    lookup_file = os.path.abspath(os.path.normpath(os.path.join(main_folder, 'lookup.dat')))

    path_to_collection = '/home/ziletti/nomad/nomad-lab-base/analysis-tools/atomic-data/tests/ExtendedBinaries_Dimers_Atoms_new.json'

    metadata_info_path = configs['metadata']['nomad_meta_info']
    metadata_info, warns = loadJsonFile(filePath=metadata_info_path, dependencyLoader=None,
                                        extraArgsHandling=InfoKindEl.ADD_EXTRA_ARGS, uri=None)

    # kwargs = {'feature_order_by': 'atomic_mulliken_electronegativity', 'energy_unit': 'eV', 'length_unit': 'angstrom'}

    energy_unit = 'eV'
    length_unit = 'angstrom'
    kwargs = {'energy_unit': energy_unit, 'length_unit': length_unit}

    descriptor = AtomicFeatures(path_to_collection=path_to_collection, metadata_info=metadata_info,
                                materials_class='binaries', configs=configs, **kwargs)

    data = [['compound', 'crystal structure type', 'target', 'IE(A)', 'IE(B)', 'Xp(A)', 'Xp(B)', 'IPF', 'x(A)', 'x(B)'],
            ['Li', 'bcc', 'metal', 5.391, 5.391, 0.98, 0.98, 2.4611, 0.5, 0.5],
            ['Na', 'bcc', 'metal', 5.138, 5.138, 0.93, 0.93, 2.0505, 0.5, 0.5],
            ['K', 'bcc', 'metal', 4.34, 4.34, 0.82, 0.82, 2.1364, 0.5, 0.5],
            ['Ba', 'bcc', 'metal', 5.212, 5.212, 0.89, 0.89, 1.5203, 0.5, 0.5],
            ['Ra', 'bcc', 'metal', 5.279, 5.279, 0.97, 0.97, 1.5089, 0.5, 0.5],
            ['Nb', 'bcc', 'metal', 6.758, 6.758, 1.6, 1.6, 0.978, 0.5, 0.5],
            ['Ta', 'bcc', 'metal', 7.887, 7.887, 1.5, 1.5, 0.8703, 0.5, 0.5],
            ['Cr', 'bcc', 'metal', 6.766, 6.766, 1.66, 1.66, 1.0667, 0.5, 0.5],
            ['Mo', 'bcc', 'metal', 7.092, 7.092, 2.16, 2.16, 1.0184, 0.5, 0.5],
            ['W', 'bcc', 'metal', 7.98, 7.98, 2.36, 2.36, 0.89, 0.5, 0.5],
            ['V', 'bcc', 'metal', 6.746, 6.746, 1.63, 1.63, 0.9212, 0.5, 0.5],
            ['Fe', 'bcc', 'metal', 7.902, 7.902, 1.83, 1.83, 1.2165, 0.5, 0.5],
            ['Eu', 'bcc', 'metal', 5.67, 5.67, 1.18, 1.18, 1.5144, 0.5, 0.5],
            ['Tc', 'hcp', 'metal', 7.275, 7.275, 1.9, 1.9, 1.0928, 0.5, 0.5],
            ['Be', 'hcp', 'metal', 9.322, 9.322, 1.57, 1.57, 2.1884, 0.5, 0.5],
            ['Mg', 'hcp', 'metal', 7.645, 7.645, 1.31, 1.31, 1.9792, 0.5, 0.5],
            ['Sc', 'hcp', 'metal', 6.561, 6.561, 1.36, 1.36, 1.2187, 0.5, 0.5],
            ['Y', 'hcp', 'metal', 6.218, 6.218, 1.22, 1.22, 1.1458, 0.5, 0.5],
            ['Ti', 'hcp', 'metal', 6.827, 6.827, 1.54, 1.54, 1.0211, 0.5, 0.5],
            ['Zr', 'hcp', 'metal', 6.634, 6.634, 1.33, 1.33, 1.0339, 0.5, 0.5],
            ['Hf', 'hcp', 'metal', 6.824, 6.824, 1.3, 1.3, 0.9938, 0.5, 0.5],
            ['Re', 'hcp', 'metal', 7.877, 7.877, 1.9, 1.9, 1.0068, 0.5, 0.5],
            ['Ru', 'hcp', 'metal', 7.361, 7.361, 2.22, 2.22, 1.1614, 0.5, 0.5],
            ['Os', 'hcp', 'metal', 8.706, 8.706, 2.2, 2.2, 1.0937, 0.5, 0.5],
            ['Co', 'hcp', 'metal', 7.88, 7.88, 1.88, 1.88, 1.3223, 0.5, 0.5],
            ['Zn', 'hcp', 'metal', 9.394, 9.394, 1.65, 1.65, 2.001, 0.5, 0.5],
            ['Cd', 'hcp', 'metal', 8.994, 8.994, 1.69, 1.69, 1.7261, 0.5, 0.5],
            ['Gd', 'hcp', 'metal', 6.15, 6.15, 1.2, 1.2, 1.0488, 0.5, 0.5],
            ['Tb', 'hcp', 'metal', 5.864, 5.864, 1.21, 1.21, 1.0489, 0.5, 0.5],
            ['Dy', 'hcp', 'metal', 5.938, 5.938, 1.22, 1.22, 1.0645, 0.5, 0.5],
            ['Ho', 'hcp', 'metal', 6.021, 6.021, 1.23, 1.23, 1.0503, 0.5, 0.5],
            ['Er', 'hcp', 'metal', 6.107, 6.107, 1.24, 1.24, 1.0859, 0.5, 0.5],
            ['Tm', 'hcp', 'metal', 6.184, 6.184, 1.25, 1.25, 1.0473, 0.5, 0.5],
            ['Lu', 'hcp', 'metal', 5.425, 5.425, 1.27, 1.27, 1.0766, 0.5, 0.5],
            ['Ca', 'fcc', 'metal', 6.112, 6.112, 1.0, 1.0, 1.907, 0.5, 0.5],
            ['Sr', 'fcc', 'metal', 5.695, 5.695, 0.95, 0.95, 1.811, 0.5, 0.5],
            ['Rh', 'fcc', 'metal', 7.459, 7.459, 2.28, 2.28, 1.1431, 0.5, 0.5],
            ['Ir', 'fcc', 'metal', 9.121, 9.121, 2.2, 2.2, 1.2059, 0.5, 0.5],
            ['Ni', 'fcc', 'metal', 7.639, 7.639, 1.91, 1.91, 1.3648, 0.5, 0.5],
            ['Pd', 'fcc', 'metal', 8.337, 8.337, 2.2, 2.2, 1.3067, 0.5, 0.5],
            ['Pt', 'fcc', 'metal', 9.017, 9.017, 2.28, 2.28, 1.4321, 0.5, 0.5],
            ['Cu', 'fcc', 'metal', 7.726, 7.726, 1.9, 1.9, 1.2259, 0.5, 0.5],
            ['Ag', 'fcc', 'metal', 7.576, 7.576, 1.93, 1.93, 1.3352, 0.5, 0.5],
            ['Au', 'fcc', 'metal', 9.225, 9.225, 2.54, 2.54, 1.6087, 0.5, 0.5],
            ['Al', 'fcc', 'metal', 5.985, 5.985, 1.61, 1.61, 2.2329, 0.5, 0.5],
            ['Ce', 'fcc', 'metal', 5.538, 5.538, 1.12, 1.12, 0.9665, 0.5, 0.5],
            ['Yb', 'fcc', 'metal', 6.253, 6.253, 1.25, 1.25, 1.5049, 0.5, 0.5],
            ['Ac', 'fcc', 'metal', 5.172, 5.172, 1.1, 1.1, 0.8996, 0.5, 0.5],
            ['Th', 'fcc', 'metal', 6.083, 6.083, 1.3, 1.3, 0.8985, 0.5, 0.5],
            ['Pr', 'dhcp', 'metal', 5.461, 5.461, 1.13, 1.13, 0.9854, 0.5, 0.5],
            ['Nd', 'dhcp', 'metal', 5.525, 5.525, 1.14, 1.14, 1.0025, 0.5, 0.5],
            ['La', 'dhcp', 'metal', 5.577, 5.577, 1.1, 1.1, 0.921, 0.5, 0.5],
            ['Am', 'dhcp', 'metal', 5.991, 5.991, 1.3, 1.3, 1.0803, 0.5, 0.5],
            ['Cm', 'dhcp', 'metal', 6.022, 6.022, 1.3, 1.3, 1.512, 0.5, 0.5],
            ['Pa', 'tetragonal', 'metal', 5.887, 5.887, 1.5, 1.5, 0.7442, 0.5, 0.5],
            ['Hg', 'rhombohedral', 'metal', 10.43, 10.43, 2.0, 2.0, 2.3946, 0.5, 0.5],
            ['Ga', 'orthorhombic', 'metal', 5.998, 5.998, 1.81, 1.81, 2.5663, 0.5, 0.5],
            ['Tl', 'hcp', 'metal', 6.108, 6.108, 1.62, 1.62, 2.2404, 0.5, 0.5],
            ['Sn', 'tetragonal', 'metal', 7.344, 7.344, 1.96, 1.96, 2.4046, 0.5, 0.5],
            ['Pb', 'fcc', 'metal', 7.416, 7.416, 2.33, 2.33, 2.3259, 0.5, 0.5],
            ['In', 'tetragonal', 'metal', 5.786, 5.786, 1.78, 1.78, 2.172, 0.5, 0.5],
            ['Pu', 'monoclinic', 'metal', 6.059, 6.059, 1.28, 1.28, 0.7313, 0.5, 0.5],
            ['Np', 'orthorhombic', 'metal', 6.265, 6.265, 1.36, 1.36, 0.6686, 0.5, 0.5],
            ['U', 'orthorhombic', 'metal', 6.193, 6.193, 1.38, 1.38, 0.6579, 0.5, 0.5],
            ['Cr3Ge', 'Cr3Si', 'metal', 6.766, 7.897, 1.66, 2.01, 1.2069, 0.75, 0.25],
            ['Cr3Si', 'Cr3Si', 'metal', 6.766, 8.151, 1.66, 1.9, 1.2088, 0.75, 0.25],
            ['Nb3Ga', 'Cr3Si', 'metal', 6.758, 5.998, 1.6, 1.81, 1.0967, 0.75, 0.25],
            ['V3Ga', 'Cr3Si', 'metal', 6.746, 5.998, 1.63, 1.81, 1.0622, 0.75, 0.25],
            ['Mo3Ga', 'Cr3Si', 'metal', 7.092, 5.998, 2.16, 1.81, 1.1212, 0.75, 0.25],
            ['Nb3Ge', 'Cr3Si', 'metal', 6.758, 7.897, 1.6, 2.01, 1.0981, 0.75, 0.25],
            ['V3Ge', 'Cr3Si', 'metal', 6.746, 7.897, 1.63, 2.01, 1.0485, 0.75, 0.25],
            ['Mo3Si', 'Cr3Si', 'metal', 7.092, 8.151, 2.16, 1.9, 1.1325, 0.75, 0.25],
            ['Nb3Sb', 'Cr3Si', 'metal', 6.758, 8.643, 1.6, 2.05, 1.0932, 0.75, 0.25],
            ['Nb3Sn', 'Cr3Si', 'metal', 6.758, 7.344, 1.6, 1.96, 1.1082, 0.75, 0.25],
            ['V3Sn', 'Cr3Si', 'metal', 6.746, 7.344, 1.63, 1.96, 1.0715, 0.75, 0.25],
            ['LaBi', 'NaCl', 'metal', 5.577, 7.286, 1.1, 2.02, 1.4232, 0.5, 0.5],
            ['HfC', 'NaCl', 'metal', 6.824, 11.26, 1.3, 2.55, 1.0283, 0.5, 0.5],
            ['ZrC', 'NaCl', 'metal', 6.634, 11.26, 1.33, 2.55, 1.0673, 0.5, 0.5],
            ['LaSb', 'NaCl', 'metal', 5.577, 8.643, 1.1, 2.05, 1.4119, 0.5, 0.5],
            ['YSb', 'NaCl', 'metal', 6.218, 8.643, 1.22, 2.05, 1.4816, 0.5, 0.5],
            ['ThC', 'NaCl', 'metal', 6.083, 11.26, 1.3, 2.55, 0.9788, 0.5, 0.5],
            ['YSe', 'NaCl', 'metal', 6.218, 9.752, 1.22, 2.55, 1.2899, 0.5, 0.5],
            ['CeAs', 'NaCl', 'metal', 5.538, 9.814, 1.12, 2.18, 1.3184, 0.5, 0.5],
            ['ErAs', 'NaCl', 'metal', 6.107, 9.814, 1.24, 2.18, 1.3323, 0.5, 0.5],
            ['GdAs', 'NaCl', 'metal', 6.15, 9.814, 1.2, 2.18, 1.3047, 0.5, 0.5],
            ['TbAs', 'NaCl', 'metal', 5.864, 9.814, 1.21, 2.18, 1.3093, 0.5, 0.5],
            ['YbAs', 'NaCl', 'metal', 6.253, 9.814, 1.25, 2.18, 1.3397, 0.5, 0.5],
            ['CeBi', 'NaCl', 'metal', 5.538, 7.286, 1.12, 2.02, 1.4296, 0.5, 0.5],
            ['DyBi', 'NaCl', 'metal', 5.938, 7.286, 1.22, 2.02, 1.412, 0.5, 0.5],
            ['ErBi', 'NaCl', 'metal', 6.107, 7.286, 1.24, 2.02, 1.4248, 0.5, 0.5],
            ['GdBi', 'NaCl', 'metal', 6.15, 7.286, 1.2, 2.02, 1.3921, 0.5, 0.5],
            ['PrBi', 'NaCl', 'metal', 5.461, 7.286, 1.13, 2.02, 1.3926, 0.5, 0.5],
            ['CrC', 'NaCl', 'metal', 6.766, 11.26, 1.66, 2.55, 1.2502, 0.5, 0.5],
            ['FeC', 'NaCl', 'metal', 7.902, 11.26, 1.83, 2.55, 2.0935, 0.5, 0.5],
            ['ScC', 'NaCl', 'metal', 6.561, 11.26, 1.36, 2.55, 1.023, 0.5, 0.5],
            ['TaC', 'NaCl', 'metal', 7.887, 11.26, 1.5, 2.55, 0.984, 0.5, 0.5],
            ['VC', 'NaCl', 'metal', 6.746, 11.26, 1.63, 2.55, 1.0733, 0.5, 0.5],
            ['CeN', 'NaCl', 'metal', 5.538, 14.53, 1.12, 3.04, 0.8554, 0.5, 0.5],
            ['CeP', 'NaCl', 'metal', 5.538, 10.48, 1.12, 2.19, 1.2824, 0.5, 0.5],
            ['CeS', 'NaCl', 'metal', 5.538, 10.36, 1.12, 2.58, 1.1872, 0.5, 0.5],
            ['CeSb', 'NaCl', 'metal', 5.538, 8.643, 1.12, 2.05, 1.4198, 0.5, 0.5],
            ['CeSe', 'NaCl', 'metal', 5.538, 9.752, 1.12, 2.55, 1.2504, 0.5, 0.5],
            ['CeTe', 'NaCl', 'metal', 5.538, 9.009, 1.12, 2.1, 1.3823, 0.5, 0.5],
            ['DyS', 'NaCl', 'metal', 5.938, 10.36, 1.22, 2.58, 1.1874, 0.5, 0.5],
            ['DySb', 'NaCl', 'metal', 5.938, 8.643, 1.22, 2.05, 1.4289, 0.5, 0.5],
            ['ErP', 'NaCl', 'metal', 6.107, 10.48, 1.24, 2.19, 1.3141, 0.5, 0.5],
            ['ErS', 'NaCl', 'metal', 6.107, 10.36, 1.24, 2.58, 1.2082, 0.5, 0.5],
            ['ErSb', 'NaCl', 'metal', 6.107, 8.643, 1.24, 2.05, 1.4355, 0.5, 0.5],
            ['ErSe', 'NaCl', 'metal', 6.107, 9.752, 1.24, 2.55, 1.2736, 0.5, 0.5],
            ['GdP', 'NaCl', 'metal', 6.15, 10.48, 1.2, 2.19, 1.2812, 0.5, 0.5],
            ['GdSb', 'NaCl', 'metal', 6.15, 8.643, 1.2, 2.05, 1.3992, 0.5, 0.5],
            ['GdSe', 'NaCl', 'metal', 6.15, 9.752, 1.2, 2.55, 1.2423, 0.5, 0.5],
            ['GdTe', 'NaCl', 'metal', 6.15, 9.009, 1.2, 2.1, 1.3601, 0.5, 0.5],
            ['PdH', 'NaCl', 'metal', 8.337, 13.59, 2.2, 2.2, 1.4386, 0.5, 0.5],
            ['RhH', 'NaCl', 'metal', 7.459, 13.59, 2.28, 2.2, 1.3302, 0.5, 0.5],
            ['HfN', 'NaCl', 'metal', 6.824, 14.53, 1.3, 3.04, 0.9576, 0.5, 0.5],
            ['HoP', 'NaCl', 'metal', 6.021, 10.48, 1.23, 2.19, 1.2759, 0.5, 0.5],
            ['HoS', 'NaCl', 'metal', 6.021, 10.36, 1.23, 2.58, 1.1835, 0.5, 0.5],
            ['HoSb', 'NaCl', 'metal', 6.021, 8.643, 1.23, 2.05, 1.4081, 0.5, 0.5],
            ['LaSe', 'NaCl', 'metal', 5.577, 9.752, 1.1, 2.55, 1.2434, 0.5, 0.5],
            ['LaTe', 'NaCl', 'metal', 5.577, 9.009, 1.1, 2.1, 1.3838, 0.5, 0.5],
            ['LuS', 'NaCl', 'metal', 5.425, 10.36, 1.27, 2.58, 1.2008, 0.5, 0.5],
            ['TcN', 'NaCl', 'metal', 7.275, 14.53, 1.9, 3.04, 1.0646, 0.5, 0.5],
            ['YbN', 'NaCl', 'metal', 6.253, 14.53, 1.25, 3.04, 0.9498, 0.5, 0.5],
            ['NdS', 'NaCl', 'metal', 5.525, 10.36, 1.14, 2.58, 1.1913, 0.5, 0.5],
            ['NdSb', 'NaCl', 'metal', 5.525, 8.643, 1.14, 2.05, 1.3942, 0.5, 0.5],
            ['NdSe', 'NaCl', 'metal', 5.525, 9.752, 1.14, 2.55, 1.2446, 0.5, 0.5],
            ['NdTe', 'NaCl', 'metal', 5.525, 9.009, 1.14, 2.1, 1.353, 0.5, 0.5],
            ['SmO', 'NaCl', 'metal', 5.643, 13.61, 1.17, 3.44, 0.9368, 0.5, 0.5],
            ['TbP', 'NaCl', 'metal', 5.864, 10.48, 1.21, 2.19, 1.2895, 0.5, 0.5],
            ['YbP', 'NaCl', 'metal', 6.253, 10.48, 1.25, 2.19, 1.3113, 0.5, 0.5],
            ['PbPo', 'NaCl', 'metal', 7.416, 8.416, 2.33, 2.0, 2.9167, 0.5, 0.5],
            ['PrS', 'NaCl', 'metal', 5.461, 10.36, 1.13, 2.58, 1.1902, 0.5, 0.5],
            ['PrSb', 'NaCl', 'metal', 5.461, 8.643, 1.13, 2.05, 1.4025, 0.5, 0.5],
            ['PrTe', 'NaCl', 'metal', 5.461, 9.009, 1.13, 2.1, 1.3679, 0.5, 0.5],
            ['ScS', 'NaCl', 'metal', 6.561, 10.36, 1.36, 2.58, 1.376, 0.5, 0.5],
            ['TbS', 'NaCl', 'metal', 5.864, 10.36, 1.21, 2.58, 1.1841, 0.5, 0.5],
            ['TmS', 'NaCl', 'metal', 6.184, 10.36, 1.25, 2.58, 1.1841, 0.5, 0.5],
            ['YS', 'NaCl', 'metal', 6.218, 10.36, 1.22, 2.58, 1.2346, 0.5, 0.5],
            ['TbSb', 'NaCl', 'metal', 5.864, 8.643, 1.21, 2.05, 1.4037, 0.5, 0.5],
            ['TmSb', 'NaCl', 'metal', 6.184, 8.643, 1.25, 2.05, 1.4124, 0.5, 0.5],
            ['ThP', 'NaCl', 'metal', 6.083, 10.48, 1.3, 2.19, 1.1878, 0.5, 0.5],
            ['ThS', 'NaCl', 'metal', 6.083, 10.36, 1.3, 2.58, 1.1083, 0.5, 0.5],
            ['ThSb', 'NaCl', 'metal', 6.083, 8.643, 1.3, 2.05, 1.3172, 0.5, 0.5],
            ['ThSe', 'NaCl', 'metal', 6.083, 9.752, 1.3, 2.55, 1.1589, 0.5, 0.5],
            ['ThAs', 'NaCl', 'metal', 6.083, 9.814, 1.3, 2.18, 1.2228, 0.5, 0.5],
            ['UC', 'NaCl', 'metal', 6.193, 11.26, 1.38, 2.55, 0.9139, 0.5, 0.5],
            ['UN', 'NaCl', 'metal', 6.193, 14.53, 1.38, 3.04, 0.8837, 0.5, 0.5],
            ['USe', 'NaCl', 'metal', 6.193, 9.752, 1.38, 2.55, 1.2308, 0.5, 0.5],
            ['UTe', 'NaCl', 'metal', 6.193, 9.009, 1.38, 2.1, 1.3761, 0.5, 0.5],
            ['NpAs', 'NaCl', 'metal', 6.265, 9.814, 1.36, 2.18, 1.3884, 0.5, 0.5],
            ['NpC', 'NaCl', 'metal', 6.265, 11.26, 1.36, 2.55, 1.0235, 0.5, 0.5],
            ['NpN', 'NaCl', 'metal', 6.265, 14.53, 1.36, 3.04, 0.9849, 0.5, 0.5],
            ['NpP', 'NaCl', 'metal', 6.265, 10.48, 1.36, 2.19, 1.3077, 0.5, 0.5],
            ['NpSb', 'NaCl', 'metal', 6.265, 8.643, 1.36, 2.05, 1.5281, 0.5, 0.5],
            ['NpTe', 'NaCl', 'metal', 6.265, 9.009, 1.36, 2.1, 1.5008, 0.5, 0.5],
            ['PuBi', 'NaCl', 'metal', 6.059, 7.286, 1.28, 2.02, 1.5624, 0.5, 0.5],
            ['PuC', 'NaCl', 'metal', 6.059, 11.26, 1.28, 2.55, 1.0525, 0.5, 0.5],
            ['PuN', 'NaCl', 'metal', 6.059, 14.53, 1.28, 3.04, 1.0218, 0.5, 0.5],
            ['PuP', 'NaCl', 'metal', 6.059, 10.48, 1.28, 2.19, 1.3141, 0.5, 0.5],
            ['PuS', 'NaCl', 'metal', 6.059, 10.36, 1.28, 2.58, 1.3199, 0.5, 0.5],
            ['PuSb', 'NaCl', 'metal', 6.059, 8.643, 1.28, 2.05, 1.5705, 0.5, 0.5],
            ['La4As3', 'iTh3P', 'metal', 5.577, 9.814, 1.1, 2.18, 1.1477, 0.571, 0.429],
            ['La4Sb3', 'iTh3P', 'metal', 5.577, 8.643, 1.1, 2.05, 1.2338, 0.571, 0.429],
            ['Sm4As3', 'iTh3P', 'metal', 5.643, 9.814, 1.17, 2.18, 1.1404, 0.571, 0.429],
            ['Ce4Bi3', 'iTh3P', 'metal', 5.538, 7.286, 1.12, 2.02, 1.2369, 0.571, 0.429],
            ['Eu4Bi3', 'iTh3P', 'metal', 5.67, 7.286, 1.18, 2.02, 1.4637, 0.571, 0.429],
            ['Gd4Bi3', 'iTh3P', 'metal', 6.15, 7.286, 1.2, 2.02, 1.2386, 0.571, 0.429],
            ['Nd4Bi3', 'iTh3P', 'metal', 5.525, 7.286, 1.14, 2.02, 1.2316, 0.571, 0.429],
            ['Pr4Bi3', 'iTh3P', 'metal', 5.461, 7.286, 1.13, 2.02, 1.2227, 0.571, 0.429],
            ['Tb4Bi3', 'iTh3P', 'metal', 5.864, 7.286, 1.21, 2.02, 1.2419, 0.571, 0.429],
            ['Yb4Bi3', 'iTh3P', 'metal', 6.253, 7.286, 1.25, 2.02, 1.4351, 0.571, 0.429],
            ['Ce4Sb3', 'iTh3P', 'metal', 5.538, 8.643, 1.12, 2.05, 1.2221, 0.571, 0.429],
            ['Dy4Sb3', 'iTh3P', 'metal', 5.938, 8.643, 1.22, 2.05, 1.2424, 0.571, 0.429],
            ['Gd4Sb3', 'iTh3P', 'metal', 6.15, 8.643, 1.2, 2.05, 1.2254, 0.571, 0.429],
            ['Nd4Sb3', 'iTh3P', 'metal', 5.525, 8.643, 1.14, 2.05, 1.215, 0.571, 0.429],
            ['Pr4Sb3', 'iTh3P', 'metal', 5.461, 8.643, 1.13, 2.05, 1.1788, 0.571, 0.429],
            ['Sm4Sb3', 'iTh3P', 'metal', 5.643, 8.643, 1.17, 2.05, 1.2276, 0.571, 0.429],
            ['Tb4Sb3', 'iTh3P', 'metal', 5.864, 8.643, 1.21, 2.05, 1.2351, 0.571, 0.429],
            ['U3As4', 'Th3P4', 'metal', 6.193, 9.814, 1.38, 2.18, 1.2608, 0.429, 0.571],
            ['Th3Bi4', 'Th3P4', 'metal', 6.083, 7.286, 1.3, 2.02, 1.3314, 0.429, 0.571],
            ['Gd3Sb4', 'Th3P4', 'metal', 6.15, 8.643, 1.2, 2.05, 1.4071, 0.429, 0.571],
            ['La3Se4', 'Th3P4', 'metal', 5.577, 9.752, 1.1, 2.55, 1.1167, 0.429, 0.571],
            ['Nd3Se4', 'Th3P4', 'metal', 5.525, 9.752, 1.14, 2.55, 1.3359, 0.429, 0.571],
            ['U3P4', 'Th3P4', 'metal', 6.193, 10.48, 1.38, 2.19, 1.2033, 0.429, 0.571],
            ['IrO2', 'TiO2', 'metal', 9.121, 13.61, 2.2, 3.44, 2.2547, 0.333, 0.667],
            ['RuO2', 'TiO2', 'metal', 7.361, 13.61, 2.22, 3.44, 2.1635, 0.333, 0.667],
            ['PtAl2', 'CaF2', 'metal', 9.017, 5.985, 2.28, 1.61, 2.0335, 0.333, 0.667],
            ['AcH2', 'CaF2', 'metal', 5.172, 13.59, 1.1, 2.2, 1.0882, 0.333, 0.667],
            ['AuGa2', 'CaF2', 'metal', 9.225, 5.998, 2.54, 1.81, 2.1779, 0.333, 0.667],
            ['AuIn2', 'CaF2', 'metal', 9.225, 5.786, 2.54, 1.78, 1.9942, 0.333, 0.667],
            ['CoSi2', 'CaF2', 'metal', 7.88, 8.151, 1.88, 1.9, 1.9364, 0.333, 0.667],
            ['DyH2', 'CaF2', 'metal', 5.938, 13.59, 1.22, 2.2, 1.1764, 0.333, 0.667],
            ['ErH2', 'CaF2', 'metal', 6.107, 13.59, 1.24, 2.2, 1.1782, 0.333, 0.667],
            ['GdH2', 'CaF2', 'metal', 6.15, 13.59, 1.2, 2.2, 1.1715, 0.333, 0.667],
            ['TiH2', 'CaF2', 'metal', 6.827, 13.59, 1.54, 2.2, 1.2785, 0.333, 0.667],
            ['YH2', 'CaF2', 'metal', 6.218, 13.59, 1.22, 2.2, 1.2165, 0.333, 0.667],
            ['SmH2', 'CaF2', 'metal', 5.643, 13.59, 1.17, 2.2, 1.1816, 0.333, 0.667],
            ['ThH2', 'CaF2', 'metal', 6.083, 13.59, 1.3, 2.2, 0.979, 0.333, 0.667],
            ['HoH2', 'CaF2', 'metal', 6.021, 13.59, 1.23, 2.2, 1.1522, 0.333, 0.667],
            ['LuH2', 'CaF2', 'metal', 5.425, 13.59, 1.27, 2.2, 1.1531, 0.333, 0.667],
            ['NbH2', 'CaF2', 'metal', 6.758, 13.59, 1.6, 2.2, 1.2692, 0.333, 0.667],
            ['NpH2', 'CaF2', 'metal', 6.265, 13.59, 1.36, 2.2, 1.3195, 0.333, 0.667],
            ['PuH2', 'CaF2', 'metal', 6.059, 13.59, 1.28, 2.2, 1.392, 0.333, 0.667],
            ['TbH2', 'CaF2', 'metal', 5.864, 13.59, 1.21, 2.2, 1.1706, 0.333, 0.667],
            ['TmH2', 'CaF2', 'metal', 6.184, 13.59, 1.25, 2.2, 1.1376, 0.333, 0.667],
            ['NiSi2', 'CaF2', 'metal', 7.639, 8.151, 1.91, 1.9, 2.019, 0.333, 0.667],
            ['PtSn2', 'CaF2', 'metal', 9.017, 7.344, 2.28, 1.96, 2.0146, 0.333, 0.667],
            ['PrTl', 'CsCl', 'metal', 5.461, 6.108, 1.13, 1.62, 1.2359, 0.5, 0.5],
            ['ThBi', 'CsCl', 'metal', 6.083, 7.286, 1.3, 2.02, 1.1899, 0.5, 0.5],
            ['CeTl', 'CsCl', 'metal', 5.538, 6.108, 1.12, 1.62, 1.216, 0.5, 0.5],
            ['DyIn', 'CsCl', 'metal', 5.938, 5.786, 1.22, 1.78, 1.3084, 0.5, 0.5],
            ['DyTl', 'CsCl', 'metal', 5.938, 6.108, 1.22, 1.62, 1.2363, 0.5, 0.5],
            ['ErIn', 'CsCl', 'metal', 6.107, 5.786, 1.24, 1.78, 1.3042, 0.5, 0.5],
            ['ErTl', 'CsCl', 'metal', 6.107, 6.108, 1.24, 1.62, 1.249, 0.5, 0.5],
            ['EuTl', 'CsCl', 'metal', 5.67, 6.108, 1.18, 1.62, 1.3817, 0.5, 0.5],
            ['HoTl', 'CsCl', 'metal', 6.021, 6.108, 1.23, 1.62, 1.2284, 0.5, 0.5],
            ['YbIn', 'CsCl', 'metal', 6.253, 5.786, 1.25, 1.78, 1.402, 0.5, 0.5],
            ['LaTl', 'CsCl', 'metal', 5.577, 6.108, 1.1, 1.62, 1.2214, 0.5, 0.5],
            ['MgTl', 'CsCl', 'metal', 7.645, 6.108, 1.31, 1.62, 1.9481, 0.5, 0.5],
            ['NdTl', 'CsCl', 'metal', 5.525, 6.108, 1.14, 1.62, 1.2178, 0.5, 0.5],
            ['SmTl', 'CsCl', 'metal', 5.643, 6.108, 1.17, 1.62, 1.2213, 0.5, 0.5],
            ['TbTl', 'CsCl', 'metal', 5.864, 6.108, 1.21, 1.62, 1.2261, 0.5, 0.5],
            ['TmTl', 'CsCl', 'metal', 6.184, 6.108, 1.25, 1.62, 1.1911, 0.5, 0.5],
            ['FeAs', 'FeAs', 'metal', 7.902, 9.814, 1.83, 2.18, 1.6468, 0.5, 0.5],
            ['AuGa', 'FeAs', 'metal', 9.225, 5.998, 2.54, 1.81, 1.9101, 0.5, 0.5],
            ['CrP', 'FeAs', 'metal', 6.766, 10.48, 1.66, 2.19, 1.5293, 0.5, 0.5],
            ['FeP', 'FeAs', 'metal', 7.902, 10.48, 1.83, 2.19, 1.5861, 0.5, 0.5],
            ['MnP', 'FeAs', 'metal', 7.434, 10.48, 1.55, 2.19, 1.5065, 0.5, 0.5],
            ['NiSi', 'FeAs', 'metal', 7.639, 8.151, 1.91, 1.9, 1.7724, 0.5, 0.5],
            ['RuP', 'FeAs', 'metal', 7.361, 10.48, 2.22, 2.19, 1.5633, 0.5, 0.5],
            ['PdSn', 'FeAs', 'metal', 8.337, 7.344, 2.2, 1.96, 1.6563, 0.5, 0.5],
            ['PtSi', 'FeAs', 'metal', 9.017, 8.151, 2.28, 1.9, 1.8227, 0.5, 0.5],
            ['RhSi', 'FeAs', 'metal', 7.459, 8.151, 2.28, 1.9, 1.5554, 0.5, 0.5],
            ['VS', 'FeAs', 'metal', 6.746, 10.36, 1.63, 2.58, 1.4168, 0.5, 0.5],
            ['TiSe', 'FeAs', 'metal', 6.827, 9.752, 1.54, 2.55, 1.4371, 0.5, 0.5],
            ['MnAs', 'NiAs', 'metal', 7.434, 9.814, 1.55, 2.18, 1.8656, 0.5, 0.5],
            ['NiAs', 'NiAs', 'metal', 7.639, 9.814, 1.91, 2.18, 1.9009, 0.5, 0.5],
            ['AuSn', 'NiAs', 'metal', 9.225, 7.344, 2.54, 1.96, 2.0501, 0.5, 0.5],
            ['MnBi', 'NiAs', 'metal', 7.434, 7.286, 1.55, 2.02, 1.9575, 0.5, 0.5],
            ['PtBi', 'NiAs', 'metal', 9.017, 7.286, 2.28, 2.02, 1.8312, 0.5, 0.5],
            ['CoSb', 'NiAs', 'metal', 7.88, 8.643, 1.88, 2.05, 1.7778, 0.5, 0.5],
            ['CrSb', 'NiAs', 'metal', 6.766, 8.643, 1.66, 2.05, 1.8719, 0.5, 0.5],
            ['VP', 'NiAs', 'metal', 6.746, 10.48, 1.63, 2.19, 1.3536, 0.5, 0.5],
            ['PdSb', 'NiAs', 'metal', 8.337, 8.643, 2.2, 2.05, 1.7883, 0.5, 0.5],
            ['PdTe', 'NiAs', 'metal', 8.337, 9.009, 2.2, 2.1, 1.8785, 0.5, 0.5],
            ['PtSn', 'NiAs', 'metal', 9.017, 7.344, 2.28, 1.96, 1.8188, 0.5, 0.5],
            ['VSe', 'NiAs', 'metal', 6.746, 9.752, 1.63, 2.55, 1.5617, 0.5, 0.5],
            ['ReO3', 'ReO3', 'metal', 7.877, 13.61, 1.9, 3.44, 2.9194, 0.25, 0.75],
            ['ThH2', 'ThH2', 'metal', 6.083, 13.59, 1.3, 2.2, 1.1474, 0.333, 0.667],
            ['TiH2', 'ThH2', 'metal', 6.827, 13.59, 1.54, 2.2, 1.238, 0.333, 0.667],
            ['ZrH2', 'ThH2', 'metal', 6.634, 13.59, 1.33, 2.2, 1.2093, 0.333, 0.667],
            ['AlAs', 'ZnS', 'nonmetal', 5.985, 9.814, 1.61, 2.18, 3.1323, 0.5, 0.5],
            ['AlP', 'ZnS', 'nonmetal', 5.985, 10.48, 1.61, 2.19, 3.2544, 0.5, 0.5],
            ['AlSb', 'ZnS', 'nonmetal', 5.985, 8.643, 1.61, 2.05, 3.0394, 0.5, 0.5],
            ['GaAs', 'ZnS', 'nonmetal', 5.998, 9.814, 1.81, 2.18, 3.0747, 0.5, 0.5],
            ['InAs', 'ZnS', 'nonmetal', 5.786, 9.814, 1.78, 2.18, 2.9129, 0.5, 0.5],
            ['BP', 'ZnS', 'nonmetal', 8.297, 10.48, 2.04, 2.19, 3.0684, 0.5, 0.5],
            ['BeS', 'ZnS', 'nonmetal', 9.322, 10.36, 1.57, 2.58, 3.3607, 0.5, 0.5],
            ['BeSe', 'ZnS', 'nonmetal', 9.322, 9.752, 1.57, 2.55, 3.1165, 0.5, 0.5],
            ['BeTe', 'ZnS', 'nonmetal', 9.322, 9.009, 1.57, 2.1, 3.0271, 0.5, 0.5],
            ['CuBr', 'ZnS', 'nonmetal', 7.726, 11.81, 1.9, 2.96, 2.7167, 0.5, 0.5],
            ['CdPo', 'ZnS', 'nonmetal', 8.994, 8.416, 1.69, 2.0, 3.0839, 0.5, 0.5],
            ['CdTe', 'ZnS', 'nonmetal', 8.994, 9.009, 1.69, 2.1, 2.8967, 0.5, 0.5],
            ['CuF', 'ZnS', 'nonmetal', 7.726, 17.42, 1.9, 3.98, 1.8501, 0.5, 0.5],
            ['GaP', 'ZnS', 'nonmetal', 5.998, 10.48, 1.81, 2.19, 3.1772, 0.5, 0.5],
            ['GaSb', 'ZnS', 'nonmetal', 5.998, 8.643, 1.81, 2.05, 3.0021, 0.5, 0.5],
            ['HgSe', 'ZnS', 'nonmetal', 10.43, 9.752, 2.0, 2.55, 3.3385, 0.5, 0.5],
            ['HgTe', 'ZnS', 'nonmetal', 10.43, 9.009, 2.0, 2.1, 3.2649, 0.5, 0.5],
            ['MgTe', 'ZnS', 'nonmetal', 7.645, 9.009, 1.31, 2.1, 3.0415, 0.5, 0.5],
            ['ZnPo', 'ZnS', 'nonmetal', 9.394, 8.416, 1.65, 2.0, 3.2869, 0.5, 0.5],
            ['ZnS', 'ZnS', 'nonmetal', 9.394, 10.36, 1.65, 2.58, 3.1606, 0.5, 0.5],
            ['Al2O3', 'Al2O3', 'nonmetal', 5.985, 13.61, 1.61, 3.44, 2.3038, 0.4, 0.6],
            ['Lu2S3', 'Al2O3', 'nonmetal', 5.425, 10.36, 1.27, 2.58, 1.7066, 0.4, 0.6],
            ['Rh2O3', 'Al2O3', 'nonmetal', 7.459, 13.61, 2.28, 3.44, 1.9034, 0.4, 0.6],
            ['Yb2S3', 'Al2O3', 'nonmetal', 6.253, 10.36, 1.25, 2.58, 1.6881, 0.4, 0.6],
            ['Ce2O3', 'La2O3', 'nonmetal', 5.538, 13.61, 1.12, 3.44, 1.0627, 0.4, 0.6],
            ['La2O3', 'La2O3', 'nonmetal', 5.577, 13.61, 1.1, 3.44, 1.0575, 0.4, 0.6],
            ['Nd2O3', 'La2O3', 'nonmetal', 5.525, 13.61, 1.14, 3.44, 1.0636, 0.4, 0.6],
            ['AgBr', 'NaCl', 'nonmetal', 7.576, 11.81, 1.93, 2.96, 2.5376, 0.5, 0.5],
            ['AgCl', 'NaCl', 'nonmetal', 7.576, 12.96, 1.93, 3.16, 2.4826, 0.5, 0.5],
            ['AgF', 'NaCl', 'nonmetal', 7.576, 17.42, 1.93, 3.98, 2.198, 0.5, 0.5],
            ['BaO', 'NaCl', 'nonmetal', 5.212, 13.61, 0.89, 3.44, 0.9924, 0.5, 0.5],
            ['BaS', 'NaCl', 'nonmetal', 5.212, 10.36, 0.89, 2.58, 1.4021, 0.5, 0.5],
            ['BaSe', 'NaCl', 'nonmetal', 5.212, 9.752, 0.89, 2.55, 1.4708, 0.5, 0.5],
            ['BaTe', 'NaCl', 'nonmetal', 5.212, 9.009, 0.89, 2.1, 1.6332, 0.5, 0.5],
            ['KBr', 'NaCl', 'nonmetal', 4.34, 11.81, 0.82, 2.96, 1.7015, 0.5, 0.5],
            ['LiBr', 'NaCl', 'nonmetal', 5.391, 11.81, 0.98, 2.96, 2.5818, 0.5, 0.5],
            ['NaBr', 'NaCl', 'nonmetal', 5.138, 11.81, 0.93, 2.96, 1.9608, 0.5, 0.5],
            ['RbBr', 'NaCl', 'nonmetal', 4.176, 11.81, 0.82, 2.96, 1.5406, 0.5, 0.5],
            ['CaS', 'NaCl', 'nonmetal', 6.112, 10.36, 1.0, 2.58, 1.5858, 0.5, 0.5],
            ['CaSe', 'NaCl', 'nonmetal', 6.112, 9.752, 1.0, 2.55, 1.7177, 0.5, 0.5],
            ['CaTe', 'NaCl', 'nonmetal', 6.112, 9.009, 1.0, 2.1, 1.6766, 0.5, 0.5],
            ['CdO', 'NaCl', 'nonmetal', 8.994, 13.61, 1.69, 3.44, 1.8881, 0.5, 0.5],
            ['CsF', 'NaCl', 'nonmetal', 3.893, 17.42, 0.79, 3.98, 0.8771, 0.5, 0.5],
            ['CsH', 'NaCl', 'nonmetal', 3.893, 13.59, 0.79, 2.2, 1.0628, 0.5, 0.5],
            ['LiF', 'NaCl', 'nonmetal', 5.391, 17.42, 0.98, 3.98, 1.6988, 0.5, 0.5],
            ['NaF', 'NaCl', 'nonmetal', 5.138, 17.42, 0.93, 3.98, 1.3524, 0.5, 0.5],
            ['RbF', 'NaCl', 'nonmetal', 4.176, 17.42, 0.82, 3.98, 1.0365, 0.5, 0.5],
            ['KH', 'NaCl', 'nonmetal', 4.34, 13.59, 0.82, 2.2, 1.3166, 0.5, 0.5],
            ['LiH', 'NaCl', 'nonmetal', 5.391, 13.59, 0.98, 2.2, 1.8835, 0.5, 0.5],
            ['NaH', 'NaCl', 'nonmetal', 5.138, 13.59, 0.93, 2.2, 1.527, 0.5, 0.5],
            ['KI', 'NaCl', 'nonmetal', 4.34, 10.45, 0.82, 2.66, 1.9005, 0.5, 0.5],
            ['LiI', 'NaCl', 'nonmetal', 5.391, 10.45, 0.98, 2.66, 2.7771, 0.5, 0.5],
            ['NaI', 'NaCl', 'nonmetal', 5.138, 10.45, 0.93, 2.66, 2.2224, 0.5, 0.5],
            ['RbI', 'NaCl', 'nonmetal', 4.176, 10.45, 0.82, 2.66, 1.7686, 0.5, 0.5],
            ['MgO', 'NaCl', 'nonmetal', 7.645, 13.61, 1.31, 3.44, 1.4368, 0.5, 0.5],
            ['MgSe', 'NaCl', 'nonmetal', 7.645, 9.752, 1.31, 2.55, 2.1463, 0.5, 0.5],
            ['SrO', 'NaCl', 'nonmetal', 5.695, 13.61, 0.95, 3.44, 1.0745, 0.5, 0.5],
            ['SrSe', 'NaCl', 'nonmetal', 5.695, 9.752, 0.95, 2.55, 1.5769, 0.5, 0.5],
            ['SrTe', 'NaCl', 'nonmetal', 5.695, 9.009, 0.95, 2.1, 1.7555, 0.5, 0.5],
            ['KCl', 'NaCl', 'nonmetal', 4.34, 12.96, 0.82, 3.16, 1.5711, 0.5, 0.5],
            ['CaO', 'NaCl', 'nonmetal', 6.112, 13.61, 1.0, 3.44, 1.1573, 0.5, 0.5],
            ['NaCl', 'NaCl', 'nonmetal', 5.138, 12.96, 0.93, 3.16, 1.8799, 0.5, 0.5],
            ['KF', 'NaCl', 'nonmetal', 4.34, 17.42, 0.82, 3.98, 1.0869, 0.5, 0.5],
            ['TlBr', 'NaCl', 'nonmetal', 6.108, 11.81, 1.62, 2.96, 3.5597, 0.5, 0.5],
            ['CoO', 'NaCl', 'nonmetal', 7.88, 13.61, 1.88, 3.44, 2.0196, 0.5, 0.5],
            ['FeO', 'NaCl', 'nonmetal', 7.902, 13.61, 1.83, 3.44, 1.8365, 0.5, 0.5],
            ['GdN', 'NaCl', 'nonmetal', 6.15, 14.53, 1.2, 3.04, 0.9402, 0.5, 0.5],
            ['EuS', 'NaCl', 'nonmetal', 5.67, 10.36, 1.18, 2.58, 1.4308, 0.5, 0.5],
            ['EuSe', 'NaCl', 'nonmetal', 5.67, 9.752, 1.18, 2.55, 1.4959, 0.5, 0.5],
            ['MnO', 'NaCl', 'nonmetal', 7.434, 13.61, 1.55, 3.44, 1.7571, 0.5, 0.5],
            ['MnSe', 'NaCl', 'nonmetal', 7.434, 9.752, 1.55, 2.55, 2.177, 0.5, 0.5],
            ['SiC', 'SiC', 'nonmetal', 8.151, 11.26, 1.9, 2.55, 2.732, 0.5, 0.5],
            ['Eu4As3', 'iTh3P', 'nonmetal', 5.67, 9.814, 1.18, 2.18, 1.2931, 0.571, 0.429],
            ['Eu3S4', 'Th3P4', 'nonmetal', 5.67, 10.36, 1.18, 2.58, 1.3278, 0.429, 0.571],
            ['CoF2', 'TiO2', 'nonmetal', 7.88, 17.42, 1.88, 3.98, 3.5631, 0.333, 0.667],
            ['FeF2', 'TiO2', 'nonmetal', 7.902, 17.42, 1.83, 3.98, 3.4804, 0.333, 0.667],
            ['MnF2', 'TiO2', 'nonmetal', 7.434, 17.42, 1.55, 3.98, 3.0701, 0.333, 0.667],
            ['NiF2', 'TiO2', 'nonmetal', 7.639, 17.42, 1.91, 3.98, 3.4912, 0.333, 0.667],
            ['VF2', 'TiO2', 'nonmetal', 6.746, 17.42, 1.63, 3.98, 2.2564, 0.333, 0.667],
            ['MgF2', 'TiO2', 'nonmetal', 7.645, 17.42, 1.31, 3.98, 2.4486, 0.333, 0.667],
            ['GeO2', 'TiO2', 'nonmetal', 7.897, 13.61, 2.01, 3.44, 2.8633, 0.333, 0.667],
            ['SnO2', 'TiO2', 'nonmetal', 7.344, 13.61, 1.96, 3.44, 2.6191, 0.333, 0.667],
            ['TiO2', 'TiO2', 'nonmetal', 6.827, 13.61, 1.54, 3.44, 1.5936, 0.333, 0.667],
            ['AgI', 'ZnO', 'nonmetal', 7.576, 10.45, 1.93, 2.66, 2.8516, 0.5, 0.5],
            ['AlN', 'ZnO', 'nonmetal', 5.985, 14.53, 1.61, 3.04, 2.3408, 0.5, 0.5],
            ['BeO', 'ZnO', 'nonmetal', 9.322, 13.61, 1.57, 3.44, 2.8158, 0.5, 0.5],
            ['CdSe', 'ZnO', 'nonmetal', 8.994, 9.752, 1.69, 2.55, 2.845, 0.5, 0.5],
            ['GaN', 'ZnO', 'nonmetal', 5.998, 14.53, 1.81, 3.04, 2.4843, 0.5, 0.5],
            ['InN', 'ZnO', 'nonmetal', 5.786, 14.53, 1.78, 3.04, 2.2947, 0.5, 0.5],
            ['ZnO', 'ZnO', 'nonmetal', 9.394, 13.61, 1.65, 3.44, 2.7009, 0.5, 0.5],
            ['CdF2', 'CaF2', 'nonmetal', 8.994, 17.42, 1.69, 3.98, 2.7845, 0.333, 0.667],
            ['CeO2', 'CaF2', 'nonmetal', 5.538, 13.61, 1.12, 3.44, 1.0431, 0.333, 0.667],
            ['SrCl2', 'CaF2', 'nonmetal', 5.695, 12.96, 0.95, 3.16, 2.1272, 0.333, 0.667],
            ['YbF2', 'CaF2', 'nonmetal', 6.253, 17.42, 1.25, 3.98, 1.5161, 0.333, 0.667],
            ['ThO2', 'CaF2', 'nonmetal', 6.083, 13.61, 1.3, 3.44, 1.1226, 0.333, 0.667],
            ['NpO2', 'CaF2', 'nonmetal', 6.265, 13.61, 1.36, 3.44, 1.2882, 0.333, 0.667],
            ['PrO2', 'CaF2', 'nonmetal', 5.461, 13.61, 1.13, 3.44, 1.0471, 0.333, 0.667],
            ['PuO2', 'CaF2', 'nonmetal', 6.059, 13.61, 1.28, 3.44, 1.3188, 0.333, 0.667],
            ['TbO2', 'CaF2', 'nonmetal', 5.864, 13.61, 1.21, 3.44, 1.1091, 0.333, 0.667],
            ['UO2', 'CaF2', 'nonmetal', 6.193, 13.61, 1.38, 3.44, 1.2053, 0.333, 0.667],
            ['AmO2', 'CaF2', 'nonmetal', 5.991, 13.61, 1.3, 3.44, 1.4571, 0.333, 0.667],
            ['CmO2', 'CaF2', 'nonmetal', 6.022, 13.61, 1.3, 3.44, 1.7014, 0.333, 0.667],
            ['EuF2', 'CaF2', 'nonmetal', 5.67, 17.42, 1.18, 3.98, 1.4587, 0.333, 0.667],
            ['PbF2', 'CaF2', 'nonmetal', 7.416, 17.42, 2.33, 3.98, 3.5918, 0.333, 0.667],
            ['CsBr', 'CsCl', 'nonmetal', 3.893, 11.81, 0.79, 2.96, 1.158, 0.5, 0.5],
            ['CsCl', 'CsCl', 'nonmetal', 3.893, 12.96, 0.79, 3.16, 1.0711, 0.5, 0.5],
            ['TlCl', 'CsCl', 'nonmetal', 6.108, 12.96, 1.62, 3.16, 3.2943, 0.5, 0.5],
            ['Cu3N', 'iReO3', 'nonmetal', 7.726, 14.53, 1.9, 3.04, 1.8149, 0.75, 0.25]]

    x = [72.986, 58.206, 49.074, 46.403, 43.35, 27.916, 36.091, 29.417, 23.714, 24.015, 25.719, 41.508, 41.26, 30.441,
         121.13, 88.303, 38.574, 36.312, 30.903, 34.212, 35.599, 32.878, 28.347, 37.68, 43.674, 107.02, 82.62, 33.057,
         29.808, 30.766, 30.956, 32.661, 32.041, 24.949, 71.239, 61.828, 27.894, 45.601, 41.697, 41.283, 51.07, 38.513,
         39.707, 53.898, 49.679, 26.466, 47.073, 21.876, 25.575, 26.006, 26.844, 26.042, 29.826, 42.178, 17.194, 130.25,
         51.008, 51.595, 66.169, 54.9, 40.85, 20.974, 19.296, 18.284, 45.341, 48.38, 24.659, 23.444, 18.674, 42.8,
         40.115, 34.834, 51.04, 37.356, 35.454, 68.683, 100.29, 101.74, 95.883, 90.719, 95.461, 100.55, 113.38, 103.48,
         104.72, 104.22, 103.23, 67.76, 61.44, 60.997, 61.584, 65.422, 95.488, 145.04, 95.37, 83.173, 83.485, 161.24,
         125.76, 113.77, 94.697, 106.17, 100.17, 104.46, 87.493, 116.39, 104.58, 86.479, 97.678, 117.26, 87.102,
         98.454, 91.99, 120.77, 107.75, 155.51, 113.93, 103.27, 85.518, 107.5, 102.1, 101.48, 118.29, 160.42, 112.16,
         91.359, 103.83, 96.327, 148.31, 117.05, 115.22, 88.664, 113.05, 92.716, 98.249, 108.59, 105.03, 101.67,
         108.61, 86.66, 84.407, 100.35, 91.503, 75.69, 84.779, 90.595, 83.965, 135.19, 84.82, 80.933, 98.326, 95.417,
         152.89, 105.61, 83.935, 89.565, 64.798, 104.25, 168.53, 112.76, 110.68, 91.655, 100.49, 83.788, 93.878,
         58.627, 65.849, 54.793, 57.351, 57.441, 54.485, 60.947, 81.511, 76.073, 76.283, 79.616, 77.927, 78.379,
         76.251, 87.995, 54.368, 87.594, 96.545, 111.44, 95.767, 189.84, 180.52, 31.948, 182.71, 30.847, 26.284,
         68.432, 178.09, 175.48, 180.3, 153.33, 184.16, 186.52, 139.08, 173.01, 167.69, 146.5, 179.19, 200.85,
         178.67, 168.08, 70.23, 47.656, 40.804, 48.59, 40.505, 35.904, 37.806, 35.211, 37.578, 43.685, 37.259,
         37.549, 41.425, 55.48, 39.854, 38.943, 37.804, 35.55, 86.673, 27.054, 101.18, 95.192, 106.75, 61.652,
         77.341, 40.605, 53.113, 45.324, 93.291, 88.747, 115.93, 95.856, 43.532, 67.042, 42.636, 70.641, 84.237,
         91.206, 60.722, 69.301, 43.024, 91.117, 284.61, 163.01, 148.47, 167.93, 187.38, 222.01, 141.02, 163.61,
         157.62, 165.2, 229.75, 188.78, 156.49, 199.43, 129.25, 139.11, 295.49, 192.79, 123.9, 158.75, 132.49,
         188.44, 141.1, 205.59, 265.05, 144.23, 154.64, 144.95, 175.76, 178.08, 172.82, 183.39, 216.05, 345.59,
         206.54, 169.09, 157.16, 148.94, 289.41, 367.45, 294.07, 262.04, 170.2, 163.36, 136.08, 206.94, 336.91,
         248.46, 526.03, 441.28, 383.58, 296.54, 354.96, 303.25, 253.1, 309.46, 260.96, 235.53, 203.16, 155.81,
         209.51, 157.86, 149.98, 321.81, 214.37, 339.52, 402.23, 306.48, 198.99, 185.89, 165.41, 130.14, 120.56,
         209.98, 133.57, 182.31, 105.55, 120.77, 575.13, 577.13, 601.06, 554.67, 420.07, 567.21, 263.87, 247.52,
         191.68, 161.35, 306.95, 332.21, 160.1, 289.77, 272.17, 303.21, 499.98, 172.51, 376.09, 368.06, 159.96,
         175.45, 171.64, 190.85, 169.79, 161.78, 207.62, 242.43, 375.13, 467.79, 204.45, 227.73, 341.55, 201.66]

    y = [4.9222, 4.101, 4.2728, 3.0406, 3.0178, 1.956, 1.7406, 2.1334, 2.0368, 1.78, 1.8424, 2.433, 3.0288, 2.1856,
         4.3768, 3.9584, 2.4374, 2.2916, 2.0422, 2.0678, 1.9876, 2.0136, 2.3228, 2.1874, 2.6446, 4.002, 3.4522, 2.0976,
         2.0978, 2.129, 2.1006, 2.1718, 2.0946, 2.1532, 3.814, 3.622, 2.2862, 2.4118, 2.7296, 2.6134, 2.8642, 2.4518,
         2.6704, 3.2174, 4.4658, 1.933, 3.0098, 1.7992, 1.797, 1.9708, 2.005, 1.842, 2.1606, 3.024, 1.4884, 4.7892,
         5.1326, 4.4808, 4.8092, 4.6518, 4.344, 1.4626, 1.3372, 1.3158, 5.8455, 5.5343, 4.9626, 4.718, 3.7581, 5.518,
         5.1717, 3.9847, 5.6026, 5.4302, 5.1537, 5.227, 4.0341, 4.0927, 5.2625, 4.9791, 3.8399, 5.3922, 5.1323, 4.6845,
         4.7404, 4.7178, 4.6729, 5.1568, 4.6758, 4.6421, 4.6867, 4.9789, 3.841, 5.8343, 3.8362, 3.3456, 3.3582, 4.6436,
         5.0151, 5.4696, 5.1975, 5.6938, 5.1836, 5.0221, 4.802, 4.6417, 5.0277, 4.7464, 5.2382, 4.6764, 4.7806, 5.2798,
         4.7604, 2.8772, 2.5671, 4.4786, 4.5434, 4.9649, 4.6937, 5.7649, 5.2836, 4.8788, 3.4067, 4.6198, 5.3922,
         5.0142, 5.5679, 4.9847, 5.5087, 4.6678, 4.5948, 5.0072, 5.4349, 5.0887, 5.0842, 5.2207, 5.0496, 4.888, 5.2218,
         4.7563, 4.6327, 4.002, 4.3991, 4.1542, 4.5465, 4.1011, 3.3775, 3.8934, 4.5486, 4.1881, 4.451, 3.8381, 4.4031,
         4.2116, 4.6068, 4.6348, 4.9313, 4.1936, 4.8536, 4.4967, 5.3208, 5.0305, 5.3019, 5.3598, 4.953, 5.2001, 5.8407,
         4.8601, 5.087, 5.0949, 4.8328, 5.4059, 5.2142, 4.8663, 4.8797, 5.0929, 4.9849, 5.0138, 4.8777, 3.4881, 3.6231,
         4.2098, 4.5336, 5.2333, 3.3443, 5.2857, 5.0262, 2.1528, 3.263, 2.3268, 2.0952, 2.934, 3.1805, 3.134, 3.22,
         2.7383, 3.2889, 3.3311, 2.4839, 3.0897, 2.9947, 2.6164, 3.2001, 3.587, 3.1909, 3.0018, 3.0111, 2.5965, 3.5436,
         3.6978, 3.5177, 3.818, 3.2833, 3.7443, 3.2635, 3.7938, 3.2358, 3.9929, 3.5976, 4.8182, 3.4611, 3.3821, 3.2831,
         3.0873, 3.9235, 2.7223, 4.0351, 3.7962, 4.2571, 3.5262, 3.0843, 2.9512, 3.0378, 2.5923, 4.4851, 4.7592,
         5.2478, 4.3392, 3.1639, 5.1021, 3.2448, 3.8771, 4.6234, 3.6373, 3.3327, 3.5862, 3.1271, 4.8863, 7.0475,
         2.9112, 2.6515, 2.999, 8.4825, 8.8536, 7.7401, 7.4065, 7.135, 6.588, 11.045, 10.124, 8.098, 8.4647, 7.2992,
         7.1989, 7.7509, 7.6885, 6.8003, 8.5132, 6.8563, 9.7514, 7.9682, 9.8841, 8.204, 5.7783, 4.7863, 5.8071, 5.44,
         5.5118, 5.3491, 7.7837, 8.1296, 9.0653, 7.6716, 8.129, 8.4282, 7.7072, 12.284, 15.596, 12.482, 11.122, 8.1827,
         8.7603, 7.0417, 7.6865, 8.8376, 5.9194, 13.798, 11.575, 10.062, 7.0647, 8.4565, 7.2245, 12.33, 15.076, 12.713,
         11.474, 7.5459, 8.3558, 7.7816, 8.4655, 7.7612, 12.109, 7.9622, 12.775, 10.551, 13.008, 7.3909, 6.9044,
         4.7637, 6.2567, 6.4653, 7.7993, 7.163, 7.3333, 5.5686, 5.0843, 11.309, 11.348, 11.819, 10.907, 8.2601,
         11.153, 7.3469, 6.8917, 5.3369, 7.8604, 8.8398, 12.339, 8.5855, 8.3451, 7.8381, 11.262, 9.8315, 4.8033,
         10.608, 7.2373, 4.4536, 4.8851, 4.7791, 5.3138, 4.7274, 4.5045, 5.7807, 6.7499, 7.3763, 9.1984, 8.6777,
         8.5688, 12.852, 11.615]

    target_class_names = ['metal', 'non metal']

    df = pd.DataFrame(data[1:], columns=data[0])
    df['coord_0'] = x
    df['coord_1'] = y

    # viewer_filename = 'l1_l0_dim2_for_viewer.csv'
    # viewer_filepath = os.path.join(results_folder, viewer_filename)

    legend_title = 'Metal/non metal class'
    target_name = 'Metal/non metal class'
    plot_title = 'SISSO(L0) structure map'

    x_axis_label = '(IE(B))^2*(IPF/Xp(A))'
    y_axis_label = '(IPF/Xp(A))*(Xp(B)/x(B))'
    target = df['target'].tolist()

    outlog_file = os.path.join(tmp_folder, 'output.log')

    df_tooltip = df[['compound', 'crystal structure type', 'target', 'coord_0', 'coord_1']]

    viewer = Viewer(configs=configs)
    file_html_link, file_html_name = viewer.plot(x=x, y=y,
                                                 outlog_file=outlog_file,
                                                 target=target,
                                                 df_tooltip=df_tooltip,
                                                 target_unit='eV',
                                                 target_name=target_name, legend_title=legend_title,
                                                 show_convex_hull=True, is_classification=True,
                                                 x_axis_label=x_axis_label, y_axis_label=y_axis_label,
                                                 plot_title=plot_title, tmp_folder=tmp_folder)

    import webbrowser
    webbrowser.open(file_html_name)




    # from PIL import Image
    #
    # png_files = []
    # for idx_img in range(len(x)):
    #     imarray = np.random.rand(100, 100, 3) * 255
    #     im = Image.fromarray(imarray.astype('uint8')).convert('RGBA')
    #     image_filename = os.path.join(tmp_folder, str(idx_img)+'random_img.png')
    #     im.save(image_filename)
    #     png_files.append(image_filename)













    sys.exit()

    # retrieve delta_e with load_descriptor using target_list
    desc_file_path = '/home/ziletti/Documents/nomadml_docs/desc_folder/atomic_features_binaries_rs.tar.gz'
    target_list, ase_atoms_list = load_descriptor(desc_files=desc_file_path, configs=configs)

    df_atomic_features = get_table_atomic_features(ase_atoms_list)

    # write table to file
    df_atomic_features.to_csv(table_file)

    # plot the table with seaborn
    df_atomic_features = df_atomic_features.set_index('chemical_formula')
    mask = df_atomic_features.isnull()
    sns.set(font_scale=0.3)
    sns_plot = sns.heatmap(df_atomic_features, annot=True, mask=mask, annot_kws={"size": 3})
    fig = sns_plot.get_figure()
    fig.tight_layout()
    fig.savefig(figure_file, dpi=200)


    logger.info("Calculation completed.")
